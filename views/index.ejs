<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <%- include('header') %>

    <% if (user) { %>
    <h1>Welcome back, <%= user.username %>!</h1>
    <% if (!user.verified) { %>
    <p>Check your email for a verification link!</p>
    <a href="javascript:resendEmailVerification()">Resend verification link</a>
    <% } %>
    <% } else { %>
    <h1>Welcome!</h1>
    <% } %>

    <% if (message) { %>
    <p><%= message %></p>
    <% } %>

    <% if (posts.length) { %>
    <h2>Posts</h2>
    <ul>
        <% for(let i = 0; i < posts.length; i++) { %>
        <li>
            <a href="/posts/<%= posts[i].slug %>"><%= posts[i].title %></a>
        </li>
        <% } %>
    </ul>
    <% } else { %>
    <h2>No posts yet!</h2>
    <% } %>

    <script>
        // <% if (user && !user.verified) { %>
        function resendEmailVerification() {
            fetch('/resend-email-verification', {
                method: 'POST',
            });
        }
        // <% } %>
    </script>
</body>

</html>
